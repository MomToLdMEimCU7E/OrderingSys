{"ast":null,"code":"export default {\n  name: \"AdvmgtDialog\",\n  props: {\n    AdvmgtDialogFlag: {\n      default: false\n    },\n    meetingId: {\n      type: String\n    }\n  },\n  data() {\n    return {\n      visible: false,\n      CmeetingId: \"\",\n      teacherUid: this.$store.getters.getUser.role.uid,\n      groupData: [],\n      userFeeData: []\n    };\n  },\n  // updated() {\n  //   this.timer = setInterval(() => {\n  //     this.loadStatus();\n  //   }, 5000);\n  // },\n  // beforeDestroy() {\n  //   clearInterval(this.timer);\n  // },\n  methods: {\n    AdvmgtDialogClose() {\n      this.$emit(\"update:AdvmgtDialogFlag\", false);\n      //   console.log(this.OrderinfoDialogFlag)\n    },\n\n    loadStatus() {\n      this.getRequest(\"/user/advertiseStatus?meetingId=\" + this.CmeetingId).then(resp => {\n        if (resp) {\n          this.groupData = resp.data.data;\n        }\n      });\n    },\n    endAdv() {\n      this.putRequest(\"/market/startOrder?meetingId=\" + this.CmeetingId + \"&teacherUid=\" + this.teacherUid).then(resp => {\n        if (resp.data.msg == \"成功\") {\n          this.$emit(\"update:AdvmgtDialogFlag\", false);\n          this.postRequest(\"/order/generateSequence?meetingId=\" + this.CmeetingId);\n          this.$parent.loadMeeting();\n          this.$message({\n            message: \"成功结束\",\n            type: \"success\"\n          });\n        } else {\n          this.loading = false;\n          this.$message.error(\"结束失败\");\n        }\n      });\n    },\n    showMoney(data) {\n      this.getRequest(\"/user/getUserFee?uid=\" + data.uid + \"&meetingId=\" + this.CmeetingId).then(resp => {\n        if (resp) {\n          this.userFeeData = resp.data.data;\n        }\n      });\n    }\n  },\n  watch: {\n    AdvmgtDialogFlag() {\n      this.visible = this.AdvmgtDialogFlag;\n      this.CmeetingId = this.meetingId;\n      this.loadStatus();\n    }\n  }\n};","map":{"version":3,"names":["name","props","AdvmgtDialogFlag","default","meetingId","type","String","data","visible","CmeetingId","teacherUid","$store","getters","getUser","role","uid","groupData","userFeeData","methods","AdvmgtDialogClose","$emit","loadStatus","getRequest","then","resp","endAdv","putRequest","msg","postRequest","$parent","loadMeeting","$message","message","loading","error","showMoney","watch"],"sources":["src/components/advmgt.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog\r\n      title=\"广告投放管理\"\r\n      :visible.sync=\"visible\"\r\n      :close-on-click-modal=\"false\"\r\n      @close=\"AdvmgtDialogClose\"\r\n      :append-to-body=\"true\"\r\n      width=\"30%\"\r\n    >\r\n      <div class=\"bg_div\">\r\n        <el-table :data=\"groupData\" style=\"width: 100%\" height=\"250\">\r\n          <el-table-column prop=\"username\" label=\"公司名称\" width=\"150\">\r\n          </el-table-column>\r\n          <el-table-column label=\"是否提交\">\r\n            <template slot-scope=\"scope\">\r\n              <el-tag type=\"success\" v-if=\"scope.row.status === '是'\"\r\n                >是</el-tag\r\n              >\r\n              <el-tag type=\"danger\" v-else-if=\"scope.row.status === '否'\"\r\n                >否</el-tag\r\n              >\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column>\r\n            <template slot-scope=\"scope\">\r\n              <el-popover placement=\"right\" width=\"300\" trigger=\"click\">\r\n                <el-table :data=\"userFeeData\">\r\n                  <el-table-column\r\n                    width=\"100\"\r\n                    property=\"market\"\r\n                    label=\"市场\"\r\n                  ></el-table-column>\r\n                  <el-table-column\r\n                    width=\"150\"\r\n                    property=\"money\"\r\n                    label=\"已投入广告费\"\r\n                  ></el-table-column>\r\n                </el-table>\r\n                <el-button slot=\"reference\" @click=\"showMoney(scope.row)\" size=\"mini\"\r\n                  >点击查看广告费</el-button\r\n                >\r\n              </el-popover>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"AdvmgtDialogClose\">关 闭</el-button>\r\n        <el-button @click=\"\" type=\"success\">刷新状态</el-button>\r\n        <el-button type=\"primary\" @click=\"endAdv\">结束广告投放</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"AdvmgtDialog\",\r\n  props: {\r\n    AdvmgtDialogFlag: {\r\n      default: false,\r\n    },\r\n    meetingId: {\r\n      type: String,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      visible: false,\r\n      CmeetingId: \"\",\r\n      teacherUid: this.$store.getters.getUser.role.uid,\r\n      groupData: [],\r\n      userFeeData: [],\r\n    };\r\n  },\r\n  // updated() {\r\n  //   this.timer = setInterval(() => {\r\n  //     this.loadStatus();\r\n  //   }, 5000);\r\n  // },\r\n  // beforeDestroy() {\r\n  //   clearInterval(this.timer);\r\n  // },\r\n  methods: {\r\n    AdvmgtDialogClose() {\r\n      this.$emit(\"update:AdvmgtDialogFlag\", false);\r\n      //   console.log(this.OrderinfoDialogFlag)\r\n    },\r\n    loadStatus() {\r\n      this.getRequest(\r\n        \"/user/advertiseStatus?meetingId=\" + this.CmeetingId\r\n      ).then((resp) => {\r\n        if (resp) {\r\n          this.groupData = resp.data.data;\r\n        }\r\n      });\r\n    },\r\n    endAdv() {\r\n      this.putRequest(\r\n        \"/market/startOrder?meetingId=\" +\r\n          this.CmeetingId +\r\n          \"&teacherUid=\" +\r\n          this.teacherUid\r\n      ).then((resp) => {\r\n        if (resp.data.msg == \"成功\") {\r\n          this.$emit(\"update:AdvmgtDialogFlag\", false);\r\n          this.postRequest(\r\n            \"/order/generateSequence?meetingId=\" + this.CmeetingId\r\n          );\r\n          this.$parent.loadMeeting();\r\n          this.$message({\r\n            message: \"成功结束\",\r\n            type: \"success\",\r\n          });\r\n        } else {\r\n          this.loading = false;\r\n          this.$message.error(\"结束失败\");\r\n        }\r\n      });\r\n    },\r\n    showMoney(data) {\r\n      this.getRequest(\r\n        \"/user/getUserFee?uid=\" + data.uid + \"&meetingId=\" + this.CmeetingId\r\n      ).then((resp) => {\r\n        if (resp) {\r\n          this.userFeeData = resp.data.data;\r\n        }\r\n      });\r\n    },\r\n  },\r\n  watch: {\r\n    AdvmgtDialogFlag() {\r\n      this.visible = this.AdvmgtDialogFlag;\r\n      this.CmeetingId = this.meetingId;\r\n      this.loadStatus();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n</style>"],"mappings":"AAyDA;EACAA,IAAA;EACAC,KAAA;IACAC,gBAAA;MACAC,OAAA;IACA;IACAC,SAAA;MACAC,IAAA,EAAAC;IACA;EACA;EACAC,KAAA;IACA;MACAC,OAAA;MACAC,UAAA;MACAC,UAAA,OAAAC,MAAA,CAAAC,OAAA,CAAAC,OAAA,CAAAC,IAAA,CAAAC,GAAA;MACAC,SAAA;MACAC,WAAA;IACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACAC,OAAA;IACAC,kBAAA;MACA,KAAAC,KAAA;MACA;IACA;;IACAC,WAAA;MACA,KAAAC,UAAA,CACA,0CAAAb,UAAA,CACA,CAAAc,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA;UACA,KAAAR,SAAA,GAAAQ,IAAA,CAAAjB,IAAA,CAAAA,IAAA;QACA;MACA;IACA;IACAkB,OAAA;MACA,KAAAC,UAAA,CACA,kCACA,KAAAjB,UAAA,GACA,iBACA,KAAAC,UAAA,CACA,CAAAa,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAAjB,IAAA,CAAAoB,GAAA;UACA,KAAAP,KAAA;UACA,KAAAQ,WAAA,CACA,4CAAAnB,UAAA,CACA;UACA,KAAAoB,OAAA,CAAAC,WAAA;UACA,KAAAC,QAAA;YACAC,OAAA;YACA3B,IAAA;UACA;QACA;UACA,KAAA4B,OAAA;UACA,KAAAF,QAAA,CAAAG,KAAA;QACA;MACA;IACA;IACAC,UAAA5B,IAAA;MACA,KAAAe,UAAA,CACA,0BAAAf,IAAA,CAAAQ,GAAA,wBAAAN,UAAA,CACA,CAAAc,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA;UACA,KAAAP,WAAA,GAAAO,IAAA,CAAAjB,IAAA,CAAAA,IAAA;QACA;MACA;IACA;EACA;EACA6B,KAAA;IACAlC,iBAAA;MACA,KAAAM,OAAA,QAAAN,gBAAA;MACA,KAAAO,UAAA,QAAAL,SAAA;MACA,KAAAiB,UAAA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}